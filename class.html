<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>创建类</title>
</head>
<body>
<script type="text/javascript">
	// 创建类的过程
	// 为类库添加继承
	var Class = function(parent) {
		var klass = function() {
			this.init.apply(this, arguments);
		};
		if (parent) {										// 继承父类实例的原型
			var subclass = function() {};
			subclass.prototype = parent.prototype;
			klass.prototype = new subclass;					// 改变klass的原型
		}

		klass.prototype.init = function() {};				// 默认的init()方法
		
		klass.fn = klass.prototype;							// 定义prototype的别名
		
		klass.fn.parent = klass;							// 定义类别名

		klass._super = klass.__proto__;						// 理解不了，不知道指向哪里
															
		klass.extend = function(obj) {						// 给类添加属性
			var extended = obj.extended;
			for(var i in obj) {
				klass[i] = obj[i];
			}
			if (extended) { extended(klass); }
		};
		
		klass.include = function(obj) {						// 给实例添加属性
			var included = obj.included;
			for(var i in obj) {
				klass.fn[i] = obj[i];
			}
			if (included) { included(klass); }
		};

		return klass;
	};			// 此分号不能省略

	(function() {
		var Animal = new Class;
		// console.dir(Animal);				// _super指向空函数
		Animal.include({
			eat: function() {
				console.log('eat');
			}
		});

		// 继承Animal
		var Cat = new Class(Animal);
		Cat.include({
			drink: function() {
				console.log('drink');
			}
		});
		console.dir(Cat);					// _super指向空函数
		// 实例化Cat
		var c = new Cat();
		c.eat();
		console.dir(c);
	})();

/*	
console.dir(c);
parent
	function()
	
drink
	function()
	
eat
	function()
	
init
	function()
	
__proto__
	Object { init=function(), parent=function(), drink=function(), 更多...}
	
	parent
		function()
		
	drink
		function()
		
	eat
		function()
		
	init
		function()
		
	__proto__
		Object { init=function(), parent=function(), eat=function()}
	
		constructor
			function()
			
		parent
			function()
			
		eat
			function()
			
		init
			function()
*/
</script>
</body>
</html>